let datos,page,nivel,pista=0;const back=document.getElementById("back");function comprobar_puntaje(){event.preventDefault();const e=document.getElementById("form_"+datos[page].name),n=document.getElementById("form_msj_"+datos[page].name),t=new FormData(e);let a=0;for(const[e,o]of t.entries()){if(console.log(e,o,datos[page].respuestas[a]),o!=datos[page].respuestas[a])return n.classList.remove("w3-hide"),!1;a++}datos[0].terminadas[datos[0].links.indexOf(page)]=1,createLamina(0)}function comprobar_puntaje_texto(){event.preventDefault();const e=document.getElementById("form_"+datos[page].name),n=document.getElementById("form_msj_"+datos[page].name),t=new FormData(e);let a=0;for(const[e,o]of t.entries()){let t=o.replace(/[^\w\s]/gi,"").trim().toLowerCase(),i=datos[page].respuestas[a].replace(/[^\w\s]/gi,"").trim().toLowerCase();if(console.log(e,t,i),t!=i)return n.classList.remove("w3-hide"),!1;a++}datos[0].terminadas[datos[0].links.indexOf(page)]=1,createLamina(0)}function cargaAudio(e){const n=document.getElementById("audios"),t=document.getElementById(e);if(!n.contains(t)){const t=document.createElement("div");t.innerHTML='<audio id="'+e+'"><source src="audios/'+e+'.mp3" type="audio/mpeg"></audio>',n.appendChild(t)}}function playAudio(e){let n=document.getElementById(e);n.currentTime=0,n.play()}function pauseAudio(e){document.getElementById(e).pause()}function isAudioPlaying(e){return!document.getElementById(e).paused}function createDiv(e){const n=document.createElement("div");n.id="vista_"+e,n.className="laminas",document.getElementById("vistas").appendChild(n)}function plantillas(e){const n=document.getElementById("vista_"+page);if(n.hasChildNodes())console.log("vacio");else{const e='<div class="w3-main" style="margin-top: 52px;"><div id="vista_'+page+'_menu" class="w3-container w3-content" style="max-width: 600px;"></div></div>';n.innerHTML=e}}function backAction(){back.onclick=function(){createLamina(0)}}function backRoad(){back.onclick=function(){window.location.href="road.html"}}function printTopics(){console.log("imprimiendo topics");const e=document.getElementById("vista_"+page+"_menu");backRoad(),e.innerHTML=`\n    <h2 class="text-azul w3-center">${datos[page].titular}</h2>\n    <div class="w3-center">\n        <p><i class="fa ${datos[page].icon} w3-jumbo text-azul"></i></p>\n        <p>${datos[page].parrafo}</p>\n    </div>\n    ${datos[page].titulos.map(((e,n)=>`\n    <br>\n    <a href="javascript:void(0);" onclick="createLamina(${datos[page].links[n]})" class="w3-button w3-border w3-round-large w3-padding-large w3-block">\n        <span class="w3-left">${e}</span>\n        <i class="fa ${datos[page].iconos[datos[page].terminadas[n]]} w3-right w3-xlarge ${datos[page].colors[datos[page].terminadas[n]]}" style="margin-top: 2px;"></i></a>\n    </a>\n    `)).join("")}\n    `}function loadEasySpeech(){const e=document.createElement("script");e.src="js/microfono.js",document.head.appendChild(e)}function printSpeaking(){console.log("imprimiendo speaking");for(let e=0;e<datos[page].audios.length;e++)cargaAudio(datos[page].audios[e]);loadEasySpeech();backAction(),pista=0,document.getElementById("vista_"+page).innerHTML='\n        <div class="w3-main w3-content" style="max-width: 600px;">\n            <div id="dialogo">\n            </div>\n        </div>\n        <div id="micro-control" class="w3-center sombra-inv w3-bottom w3-padding-16" style="padding-bottom: 15px;">\n            <div id="pista" class="w3-padding w3-hide">How are you?</div>\n            <button id="btnstart" class="w3-button azul w3-round-xxlarge" onclick="empezando()">Comenzar</button>\n            <button id="btnmicro" class="w3-circle azul w3-xlarge w3-hide" style="padding: 10px 21px; border: 0;" onclick="microfono()"><i class="fa fa-microphone"></i></button>\n        </div>\n    '}function printListening(){console.log("imprimiendo listening");for(let e=0;e<datos[page].audios.length;e++)cargaAudio(datos[page].audios[e]);const e=`\n        <p class="w3-medium w3-center">Escucha y responde con la opción correcta</p>\n        <form id="form_${datos[page].name}">\n            ${datos[page].audios.map(((e,n)=>`\n            <br>\n            <div class="w3-row">\n                <div class="w3-col text-azul" style="width:50px;">\n                    <a href="javascript:void(0);" class="w3-xlarge btn-audio" onclick="playAudio('${e}')"><i class="fa fa-play-circle w3-xxlarge vertical"></i></a>\n                </div>\n                <div class="w3-rest">\n                    <select name="name${n}" class="w3-input w3-round-large w3-border">\n                        ${datos[page].opciones[n].map(((e,n)=>`<option value="${n}">${e}</option>`)).join("")}\n                    </select>\n                </div>\n            </div>\n            `)).join("")}\n        <p id="form_msj_${datos[page].name}" class="w3-medium w3-center w3-hide w3-red">La respuesta es incorrecta</p>\n            <div class="w3-center w3-padding-large">\n                <button class="w3-button azul w3-round-xxlarge" onclick="comprobar_puntaje()">Accept</button>\n                <br><br>\n            </div>\n        </form>\n    `;backAction(),document.getElementById("vista_"+page+"_menu").innerHTML=e}function printPracticeMenu(){console.log("imprimiendo practice");const e=`\n        <p class="w3-medium w3-center">Selecciona la palabra correcta</p><br>\n        <form id="form_${datos[page].name}">\n            ${datos[page].words.map(((e,n)=>`\n                <p>${e} &nbsp;\n                <select name="name${n}" class="w3-input w3-border w3-round-large">\n                    ${datos[page].opciones[n].map(((e,n)=>`<option value="${n}">${e}</option>`)).join("")}\n                </select>\n                </p>\n            `)).join("")}\n            <p id="form_msj_${datos[page].name}" class="w3-medium w3-center w3-hide w3-red">La respuesta es incorrecta</p>\n            <div class="w3-center w3-padding-large">\n                <button class="w3-button azul w3-round-xxlarge" onclick="comprobar_puntaje()">Accept</button>\n                <br><br>\n            </div>\n        </form>\n    `;backAction(),document.getElementById("vista_"+page+"_menu").innerHTML=e}function printWriting(){console.log("imprimiendo writing");const e=`\n      <p class="w3-medium w3-center">${datos[page].parrafo}</p><br>\n      <form id="form_${datos[page].name}">\n        ${datos[page].words.map(((e,n)=>`\n          <p>${e} &nbsp; <input class="w3-input w3-round-large w3-border" type="text" name="name${n}">\n        `)).join("")}\n        <p id="form_msj_${datos[page].name}" class="w3-medium w3-center w3-hide w3-red">La respuesta es incorrecta</p>\n        <div class="w3-center w3-padding-large">\n          <button class="w3-button azul w3-round-xxlarge" onclick="comprobar_puntaje_texto()">Accept</button>\n          <br><br>\n        </div>\n      </form>\n    `;backAction(),document.getElementById("vista_"+page+"_menu").innerHTML=e}function printFrases(){console.log("imprimiendo frases");for(let e=0;e<datos[page].audios.length;e++)cargaAudio(datos[page].audios[e]);if(!document.getElementById("vista_"+page+"_menu").hasChildNodes()){const e=`\n            <div class="w3-center">\n                <h2 class="text-azul">${datos[page].titulo}</h2>\n                <p class="w3-medium">${datos[page].parrafo}</p>\n                <button id="btn_play" onclick="btnFrases('${datos[page].audios[0]}')" class="w3-circle azul w3-xlarge w3-hover-gray" style="padding: 5px 12px; border: 0; position:relative; top: 10px;"><i class="fa fa-volume-up"></i></button>\n                <br>\n                <div>\n                ${datos[page].frases.map(((e,n)=>`\n                    <div class="w3-left-align w3-padding-large" style="border-top: 1px solid #ccc;">\n                        <span>${e}</span><br>\n                        <span class="traduc">${datos[page].traducciones[n]}</span>\n                    </div>\n                `)).join("")}\n                    <div style="border-top: #ccc solid 1px;"></div>\n                </div>\n            </div>\n        `;backAction(),document.getElementById("vista_"+page+"_menu").innerHTML=e;const n=document.createElement("div");n.innerHTML=`\n        <br><br>\n        \x3c!-- boton continue --\x3e\n        <div class="w3-bottom w3-center w3-padding-large">\n            <button id="btn_continue_${page}" onclick="btnContinueFrases()" class="w3-button azul w3-round-xxlarge w3-hide">${datos[page].boton}</button>\n            <br><br>\n        </div>`,document.getElementById("vista_"+page).appendChild(n)}}function btnFrases(e){playAudio(e),document.getElementById("btn_continue_"+page).classList.remove("w3-hide")}function btnContinueFrases(){isAudioPlaying(datos[page].audios[0])&&pauseAudio(datos[page].audios[0]),document.getElementById("btn_continue_"+page).classList.add("w3-hide"),0===datos[page].link&&(datos[0].terminadas[datos[page].refTopic]=1),createLamina(datos[page].link)}function printGrammar(){console.log("imprimiendo grammar");const e=document.getElementById("vista_"+page+"_menu");e.hasChildNodes()||fetch("nivel1/html/"+datos[page].contenido).then((e=>e.text())).then((n=>{e.innerHTML=n,backAction();const t=document.createElement("div");t.innerHTML=`\n            <br><br>\n            \x3c!-- boton continue --\x3e\n            <div class="w3-bottom w3-center w3-padding-large">\n                <button id="btn_continue_${page}" onclick="btnContinueGrammar()" class="w3-button azul w3-round-xxlarge">${datos[page].boton}</button>\n                <br><br>\n            </div>`,document.getElementById("vista_"+page).appendChild(t)}))}function btnContinueGrammar(){0===datos[page].link&&(datos[0].terminadas[datos[0].links.indexOf(page)]=1),createLamina(datos[page].link)}function createLamina(e){page=e,plantillas("vista_"+page),muestra("vista_"+page),choicePrint(datos[page].func)}function muestra(e){const n=document.getElementById(e);document.querySelectorAll(".laminas").forEach((function(e){e.classList.add("w3-hide")})),n.classList.remove("w3-hide")}function choicePrint(e){const n={0:printTopics,1:printPracticeMenu,2:printWriting,3:printListening,4:printSpeaking,5:printGrammar,6:printFrases}[e];n?n():console.log("No existe la función")}function setCookie(e,n,t){const a=new Date;a.setTime(a.getTime()+24*t*60*60*1e3);let o="expires="+a.toUTCString();document.cookie=e+"="+n+";"+o+";path=/"}function getCookie(e){let n=e+"=",t=document.cookie.split(";");for(let e=0;e<t.length;e++){let a=t[e];for(;" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(n))return a.substring(n.length,a.length)}return""}function checkCookie(){let e=getCookie("username");""!=e?alert("Welcome again "+e):(e=prompt("Please enter your name:",""),""!=e&&null!=e&&setCookie("username",e,365))}